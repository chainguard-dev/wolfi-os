package:
  name: commons-crypto
  version: 1.2.0
  epoch: 0
  description: "Apache Commons Crypto library, version 1.2.0"
  copyright:
    - license: Apache-2.0

environment:
  contents:
    packages:
      - wolfi-base
      - build-base
      - openssl-dev
      - openjdk-11-default-jvm
      - openjdk-11
      - maven
      - make
      - gcc

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/apache/commons-crypto
      expected-commit: 949378606cdb1c837159006a320f16d08c528097
      tag: rel/commons-crypto-${{package.version}}

  - uses: patch
    with:
      patches: 0001-PATCH-Add-OpenSSL3-Support.patch

  - runs: |
      export JAVA_HOME=/usr/lib/jvm/java-11-openjdk
      mvn package -Drat.skip=true

  - runs: |
      mkdir -p ${{targets.destdir}}/usr/share/java/commons-crypto
      mv /home/build/target/commons-crypto-${{package.version}}.jar ${{targets.destdir}}/usr/share/java/commons-crypto/commons-crypto.jar

update:
  enabled: true
  github:
    identifier: apache/commons-crypto
    use-tag: true
    tag-filter: rel/commons-crypto-
    strip-prefix: rel/commons-crypto-
