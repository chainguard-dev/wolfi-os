package:
  name: jasper
  version: "4.2.4"
  epoch: 0
  description: JasPer is a collection of software (i.e., a library and application programs) for the coding and manipulation of images
  copyright:
    - license: Apache

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - cmake
      - gcc

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/jasper-software/jasper
      tag: version-${{package.version}}
      expected-commit: 8766848706a727f61c1c76a5a7cf1078433fad02
  - runs: 
      mkdir -p {{targets.contextdir}}/output
  - uses: cmake/configure
    with:
      opts: |
        -DINSTALL_PREFIX=/usr \
        -DSOURCE_DIR=. \
        -B$BUILD_DIR=/output

  - working-directory: /

    uses: cmake/build

  - uses: strip


update:
  enabled: true
  github:
    identifier: jasper-software/jasper
    strip-prefix: version_

test:
  pipeline:
    - runs: |
        jasper --help
        jasper --version