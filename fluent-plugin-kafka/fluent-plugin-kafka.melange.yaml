package:
  name: fluent-plugin-kafka
  version: 0.19.3
  epoch: 1
  description: Fluentd plugin for Apache Kafka
  target-architecture:
    - x86_64
    #- aarch64

environment:
  contents:
    repositories:
      - https://packages.wolfi.dev/os
    keyring:
      - https://packages.wolfi.dev/os/wolfi-signing.rsa.pub
    packages:
      - ruby
      - busybox
      - git
pipeline:
  - uses: fetch
    with:
      uri: https://github.com/fluent/fluent-plugin-kafka/archive/refs/tags/v0.19.3.tar.gz
      expected-sha256: 23e6c06b6e315d66497cbd4a01ad6cef905592354c7161e4100742de44f3341e
  - runs: echo "Starting build..."
  - runs: tar -xzf v0.19.3.tar.gz || { echo "Extracting archive failed"; exit 1; }
  - runs: |
      cd fluent-plugin-kafka-0.19.3 || { echo "Directory not found"; exit 1; }
      gem build fluent-plugin-kafka.gemspec || { echo "Gem build failed"; exit 1; }
  - runs: echo "Build completed successfully."
