package:
  name: wireless-tools
  version: 29
  epoch: 0
  description: "Wireless Tools for Linux"
  copyright:
    - license: LGPL-2.0-only

environment:
  contents:
    packages:
      - build-base
      - busybox
      - ca-certificates-bundle

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/HewlettPackard/wireless-tools.git
      expected-commit: c7b2e81e6d53daac413a19d5446ab68b8395c849
      tag: v${{package.version}}

  - runs: |
      cd wireless_tools
      CFLAGS="$CFLAGS -flto=auto" \
      make

  - runs: |
      cd wireless_tools
      make INSTALL_DIR="${{targets.destdir}}"/usr/sbin \
      INSTALL_LIB="${{targets.destdir}}"/usr/lib \
      INSTALL_INC="${{targets.destdir}}"/usr/include \
      INSTALL_MAN="${{targets.destdir}}"/usr/share/man install

  - uses: strip

subpackages:
  - name: "wireless-tools-doc"
    description: "wireless-tools documentation"
    pipeline:
      - uses: split/manpages

  - name: "wireless-tools-dev"
    description: "wireless-tools development headers"
    pipeline:
      - uses: split/dev

update:
  enabled: true
  github:
    identifier: HewlettPackard/wireless-tools
    use-tag: true
    strip-prefix: v
