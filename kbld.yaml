package:
  name: kbld
  version: 0.44.1
  epoch: 0
  description: kbld seamlessly incorporates image building and image pushing into your development and deployment workflows
  copyright:
    - license: Apache-2.0

pipeline:
  - uses: git-checkout
    with:
      expected-commit: fac5bb8f504df2d5231aeb383418112c592ca15c
      repository: https://github.com/carvel-dev/kbld
      tag: v${{package.version}}

  - uses: go/build
    with:
      packages: ./cmd/kbld
      output: kbld
      ldflags: -X carvel.dev/kbld/pkg/kbld/version.Version=v${{package.version}}

  - uses: strip

update:
  enabled: true
  github:
    identifier: carvel-dev/kbld
    strip-prefix: v

test:
  pipeline:
    - name: version check
      runs: |
        kbld version | grep ${{package.version}}
