package:
  name: bash_completion
  version: 2.12.0
  epoch: 0
  description: Programmable completion functions for bash
  copyright:
    - license: GPL-2.0-or-later
  dependencies:
    runtime:
      - bash
  scriptlets:
    post-install: |
      #!/bin/bash
      source /etc/bash/bash_completion.sh
environment:
  contents:
    packages:
      - bash
      - busybox
      - make
      - wolfi-baselayout
      - build-base
      - autoconf
      - automake
pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/scop/bash-completion
      tag: ${{ package.version }}
      expected-commit: "88587c871a8519d2d628d3e46d59ca34e09330b0"
  - runs: |
      autoreconf -i
      ./configure --prefix=/usr \
          --sysconfdir=/etc \
          --mandir=/usr/share/man \
          --localstatedir=/var
      make
      make DESTDIR=${{targets.destdir}} install
      mkdir -p ${{targets.destdir}}/etc/bash
      mv ${{targets.destdir}}/etc/profile.d/bash_completion.sh ${{targets.destdir}}/etc/bash/
      rmdir -p ${{targets.destdir}}/etc/profile.d/ || true
      mkdir -p ${{targets.destdir}}/usr/lib
      mv ${{targets.destdir}}/usr/share/pkgconfig ${{targets.destdir}}/usr/lib/pkgconfig
update:
  enabled: true
  github:
    identifier: scop/bash-completion
