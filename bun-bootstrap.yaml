package:
  name: bun-bootstrap
  version: 1.1.43
  epoch: 0
  description: "Bun requires itself to bootstrap."
  copyright:
    - license: MIT
  options:
    no-provides: true

environment:
  contents:
    packages:
      - bash
      - busybox
      - curl

pipeline:
  - assertions:
      required-steps: 1
    pipeline:
      - if: ${{build.arch}} == 'aarch64'
        uses: fetch
        with:
          uri: "https://github.com/oven-sh/bun/releases/download/bun-v${{package.version}}/bun-linux-aarch64.zip"
          expected-sha256: "4a3239bb58e19ac44c443aa900dba1ab2cf76020a25b3cf55c9c46e486616ab3"
          extract: false
      - if: ${{build.arch}} == 'x86_64'
        uses: fetch
        with:
          uri: "https://github.com/oven-sh/bun/releases/download/bun-v${{package.version}}/bun-linux-x64.zip"
          expected-sha256: "8f98aa87091557647dc23c65c3206b14ee902c8e27d0203daa1200b2d1fa3c21"
          extract: false

  - runs: |
      unzip bun*.zip
      rm *.zip
      mkdir -p ${{targets.destdir}}/usr/bin
      mv bun*/bun ${{targets.destdir}}/usr/bin/

update:
  enabled: true
  github:
    identifier: oven-sh/bun
    use-tag: true
    strip-prefix: bun-v

test:
  pipeline:
    - runs: |
        bun --version
