package:
  name: dns-root-hints
  version: "2022062901"
  epoch: 0
  description: The DNS root hint(s)
  copyright:
    - license: Public-Domain

environment:
  contents:
    packages:
      - busybox
      - ca-certificates-bundle
      - build-base
      - gpg
      - curl
      - gpgv

pipeline:
  - runs: |
      # Convert the key to the GPG keyring that can be used with gpgv.
      gpg --dearmor -o verisign-grs-nstld-key.gpg verisign-grs-nstld-key.asc

      mkdir -p ${{targets.contextdir}}/usr/share
      mkdir -p ${{targets.contextdir}}/usr/bin
      mkdir -p ${{targets.contextdir}}/etc/periodic/monthly/

      install -D -m 644 -t ${{targets.contextdir}}/usr/share/dns-root-hints \
        named.root \
        named.root.sig \
        verisign-grs-nstld-key.asc \
        verisign-grs-nstld-key.gpg

      install -D -m 755 -t ${{targets.contextdir}}/usr/bin/ update-dns-root-hints

      # compatibility links
      cd ${{targets.contextdir}}/usr/share/dns-root-hints

      ln -s named.root named.cache
      ln -s named.root db.cache

update:
  enabled: false
