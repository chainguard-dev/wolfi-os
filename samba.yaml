#nolint:git-checkout-must-use-github-updates
package:
  name: samba
  version: 4.19.5
  epoch: 0
  description: Samba is the standard Windows interoperability suite of programs for Linux and Unix
  copyright:
    - license: GPL-3.0-only

environment:
  contents:
    packages:
      - acl-dev
      - autoconf
      - automake
      - bison
      - build-base
      - busybox
      - ca-certificates-bundle
      - dbus-dev
      - flex
      - gnutls-dev
      - gpgme
      - gpgme-dev
      - groff
      - heimdal-dev
      - jansson-dev
      - libarchive-dev
      - libgpg-error-dev
      - libxslt-dev
      - linux-pam-dev
      - lmdb-dev
      - ncurses
      - ncurses-dev
      - ncurses-terminfo
      - nfs-utils
      - openldap-dev
      - pcre-dev
      - perl-dev
      - perl-json
      - perl-yapp
      - pkgconf
      - popt-dev
      - py3-dnspython
      - py3-markdown
      - python3
      - python3-dev
      - zlib-dev

pipeline:
  - uses: git-checkout
    with:
      repository: https://gitlab.com/samba-team/samba
      tag: samba-${{package.version}}
      expected-commit: 7bef2f7f1c89bd635e318a2f860fdb7254ba1083

  - uses: autoconf/configure
    with:
      opts: |
        LDFLAGS="-ltinfo" \
        --enable-fhs \
        --build=${{host.triplet.gnu}} \
        --host=${{host.triplet.gnu}} \
        --prefix=/usr \
        --sysconfdir=/etc \
        --mandir=/usr/share/man \
        --infodir=/usr/share/info \
        --localstatedir=/var

  - uses: autoconf/make

  - uses: autoconf/make-install

subpackages:
  - name: samba-doc
    dependencies:
      runtime:
        - samba
    pipeline:
      - uses: split/manpages
    description: samba manpages

update:
  enabled: true
  release-monitor:
    identifier: 4758
