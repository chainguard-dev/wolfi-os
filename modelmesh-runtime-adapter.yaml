package:
  name: modelmesh-runtime-adapter
  version: 0.12.0
  epoch: 0
  description: Unified runtime-adapter package of the sidecar containers which run in the modelmesh pods

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/kserve/modelmesh-runtime-adapter.git
      expected-commit: 5d0c9a008cce30b2b3839874c9f1f2ca8ddc38de
      tag: v${{package.version}}

data:
  - name: controller-components
    items:
      model-mesh-mlserver-adapter: 
        bump: true
        description: "Adapter which implements the internal model-mesh model management API for MLServer Inference Server."
        test: "MLServer runtime adapter started"
      model-mesh-ovms-adapter: "OVMS Runtime started"
        bump: true
        description: "Adapter which implements the internal model-mesh model management API for MLServer Inference Server."
        test: "MLServer runtime adapter started"
      model-mesh-torchserve-adapter: "TorchServe runtime adapter started"
        bump: true
        description: "Adapter which implements the internal model-mesh model management API for MLServer Inference Server."
        test: "MLServer runtime adapter started"
      model-mesh-triton: "Triton runtime adapter started"
        bump: true
        description: "Adapter which implements the internal model-mesh model management API for MLServer Inference Server."
        test: "MLServer runtime adapter started"
      model-serving-puller: "starting clean up of cached clients"
        bump: true
        description:  "starting clean up of cached clients"
       test: "MLServer runtime adapter started"

subpackages:
  - range: controller-components
    name: "${{range.key}}"
    pipeline:
      - uses: go/build
        with:
          output: ${{range.key}}
          packages: ./${{range.key}}
          ldflags: -s -w
      - uses: strip
    test:
      pipeline:
        - runs: |
            export CONTAINER_MEM_REQ_BYTES=1
            ${{range.key}} | grep ${{range.value}}
