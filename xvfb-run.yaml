#nolint:valid-pipeline-git-checkout-commit,valid-pipeline-git-checkout-tag
package:
  name: xvfb-run
  version: 0_git20250126
  epoch: 0
  description: imlib2 dev
  copyright:
    - license: SGI-B-2.0
  dependencies:
    runtime:
      - coreutils
      - xauth
      - mcookie

environment:
  contents:
    packages:
      - busybox

pipeline:
  - uses: git-checkout
    with:
      repository: https://salsa.debian.org/xorg-team/xserver/xorg-server
      branch: debian-unstable # reason we use branch instead of tag: https://github.com/wolfi-dev/os/pull/13691#issue-2154225731
      expected-commit: 4c5d2ac2b36d6da2a5b0f5b87ad90f5409d1532d

  - working-directory: debian/local
    pipeline:
      - runs: |
          install -Dm755 xvfb-run "${{targets.contextdir}}"/usr/bin/xvfb-run
          install -D xvfb-run.1 "${{targets.contextdir}}"/usr/share/man/man1/xvfb-run.1

subpackages:
  - name: ${{package.name}}-doc
    pipeline:
      - uses: split/manpages
    description: xvfb-run manpages

test:
  pipeline:
    - runs: |
        xvfb-run --help

update:
  enabled: true
  git: {}
  schedule:
    period: weekly
    reason: poll based on branches not tags # https://github.com/wolfi-dev/os/pull/13691#issue-2154225731
